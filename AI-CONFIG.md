# AI生成功能配置说明

## 🎯 功能说明
听力微练习页面的"AI生成题目"功能，可以自动识别音频内容并生成听力题目。

## 🔧 技术优化（已完成）

### 1. **添加重试机制**
- 自动重试3次，提高成功率
- 网络不稳定时自动重试
- API限流时智能等待后重试

### 2. **超时控制**
- 音频加载超时：15秒
- API请求超时：30秒
- 避免长时间无响应

### 3. **错误处理优化**
- 更详细的错误信息
- 针对性的解决建议
- 用户友好的提示

### 4. **音频文件优化**
- 自动回退到set1音频
- 大文件警告提示
- 文件大小检查

## 📊 故障排除

### 常见错误及解决方案

#### ❌ "Failed to fetch"
**原因**：
1. 浏览器CORS限制（某些浏览器更严格）
2. 网络无法访问外部API
3. 防火墙/代理阻止

**解决方案**：
1. 使用Chrome/Edge浏览器（兼容性最好）
2. 检查网络连接
3. 暂时关闭VPN/代理重试
4. 检查防火墙设置

#### ❌ "请求超时"
**原因**：
1. 网络速度慢
2. 音频文件过大
3. API服务器响应慢

**解决方案**：
1. 检查网络速度
2. 稍后重试
3. 使用较小的音频文件

#### ❌ "API繁忙"
**原因**：
1. API使用量达到限制
2. 服务器负载高

**解决方案**：
1. 等待几秒后重试
2. 使用缓存的结果
3. 错峰使用

## 🚀 性能优化

1. **缓存机制**：生成的题目自动缓存，下次直接使用
2. **智能回退**：音频文件不存在时自动使用同期音频
3. **进度显示**：实时显示处理进度和耗时
4. **快速生成**：截取前1200字符，加快处理速度

## 💡 使用建议

1. **首次使用**：可能需要10-30秒，请耐心等待
2. **网络要求**：需要稳定的网络连接
3. **浏览器推荐**：Chrome、Edge、Firefox最新版
4. **缓存使用**：如果已生成题目，直接使用缓存更快

## 🔐 安全说明

当前API密钥是硬编码的测试密钥，有以下限制：
- 可能会达到使用限制
- 不适合生产环境
- 建议迁移到后端服务

### 生产环境建议
建议将API调用迁移到后端服务器：
1. 在backend/server.js添加代理接口
2. 使用环境变量管理密钥
3. 添加请求频率限制
4. 记录使用日志

## 📈 监控指标

系统会自动显示：
- ✅ 处理进度（识别音频 → 生成题目）
- ⏱️ 处理时间
- 🔄 重试次数
- ✨ 成功/失败状态

## 🆘 紧急故障恢复

如果AI生成功能完全无法使用：
1. 检查浏览器控制台错误
2. 尝试清除缓存和Cookie
3. 使用无痕模式测试
4. 更换浏览器测试
5. 检查网络连接

## 📞 技术支持

遇到问题请提供：
- 浏览器版本
- 错误截图
- 控制台错误信息
- 网络环境（校园网/家庭网/移动网络）
