<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å››å…­çº§é˜…è¯»ç¥å™¨ - ç¿»è¯‘å·¥å…·</title>
   <!-- ğŸ‘‡ğŸ‘‡ ç»ˆæç‰ˆ Favicon (å†…è”SVG, æ— éœ€å¤–éƒ¨è¯·æ±‚, 100% ç»•è¿‡ç¼“å­˜) ğŸ‘‡ğŸ‘‡ -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23007AFF' /><text x='50' y='50' font-size='50' fill='%23FFF' text-anchor='middle' dominant-baseline='central' font-family='system-ui' font-weight='bold'>CET</text></svg>" type="image/svg+xml">
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- é¡µé¢æ»šåŠ¨è¿›åº¦æ¡ -->
    <div class="scroll-progress" id="scroll-progress"></div>
    <!-- ç®€æ´å¯¼èˆªæ  -->
    <nav class="apple-nav wehuster-nav">
        <div class="nav-container">
            <a class="nav-logo wehuster-logo" href="index.html">
                <i class="fas fa-graduation-cap"></i>
                <span class="logo-text">å››å…­çº§å­¦ä¹ ç«™</span>
            </a>
            
            <ul class="nav-menu wehuster-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">é¦–é¡µ</a></li>
                <li class="nav-item"><a href="cet4.html" class="nav-link">å››çº§çœŸé¢˜</a></li>
                <li class="nav-item"><a href="cet6.html" class="nav-link">å…­çº§çœŸé¢˜</a></li>
                <li class="nav-item"><a href="translator.html" class="nav-link">é˜…è¯»ç¥å™¨</a></li>
                <li class="nav-item"><a href="listening-micro.html" class="nav-link listening-highlight" style="background: white; color: #667eea !important; border-radius: 8px; padding: 6px 14px; font-weight: 700; box-shadow: 0 4px 12px rgba(255, 255, 255, 0.4); border: 2px solid rgba(255, 255, 255, 0.8); position: relative; transition: all 0.3s ease; animation: pulse 2s ease-in-out infinite; white-space: nowrap;" onmouseover="this.style.transform='translateY(-2px) scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(255, 255, 255, 0.6)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 4px 12px rgba(255, 255, 255, 0.4)';"><span style="font-size: 1em;">ğŸ§</span> å¬åŠ›ç»ƒä¹  <span style="font-size: 0.65em; background: linear-gradient(135deg, #ff6b6b, #feca57); color: white; padding: 2px 5px; border-radius: 8px; margin-left: 3px; font-weight: 800;">HOT</span></a></li>
                <style>
                  @keyframes pulse {
                    0%, 100% { box-shadow: 0 4px 12px rgba(255, 255, 255, 0.4); }
                    50% { box-shadow: 0 4px 16px rgba(255, 255, 255, 0.7); }
                  }
                </style>
                <li class="nav-item"><a href="reading-micro.html" class="nav-link">å¬åŠ›å¾®ç»ƒä¹ </a></li>
                <li class="nav-item"><a href="news.html" class="nav-link">èµ„è®¯</a></li>
                <li class="nav-item"><a href="about.html" class="nav-link">About Us</a></li>
            </ul>
            
            <div class="nav-tools">
                <button class="search-btn" id="search-toggle" aria-label="æœç´¢">
                    <i class="fas fa-search"></i>
                </button>
                <button class="mobile-toggle" id="mobile-toggle" aria-label="èœå•">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </nav>
    <main class="page-content" style="background: #fafbff; min-height: 80vh; padding: 3rem 2rem;">
        <!-- é¡µé¢æ ‡é¢˜åŒºåŸŸ -->
        <div style="text-align: center; margin-bottom: 3rem;">
            <div style="display: inline-block; position: relative;">
                <h1 style="font-size: 2.8rem; font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem;">
                    <i class="fas fa-language" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
                    å››å…­çº§é˜…è¯»ç¥å™¨
                </h1>
                <div style="height: 4px; background: linear-gradient(90deg, transparent, #667eea, transparent); border-radius: 2px;"></div>
            </div>
            <p style="color: #64748b; margin-top: 1rem; font-size: 1.05rem;">æ™ºèƒ½ç¿»è¯‘åŠ©æ‰‹ï¼Œè½»æ¾ç†è§£è‹±æ–‡å†…å®¹</p>
        </div>
        
        <!-- ä¸»ç¿»è¯‘å¡ç‰‡ -->
        <div style="max-width: 900px; margin: 0 auto;">
            <div id="main-container" style="background: white; padding: 2.5rem; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); border: 2px solid #f0f0f0; transition: all 0.3s ease;">
                <!-- è¾“å…¥åŒºåŸŸæ ‡é¢˜ -->
                <div style="display: flex; align-items: center; gap: 0.8rem; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #f0f0f0;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                        <i class="fas fa-pen" style="color: white; font-size: 1.1rem;"></i>
                    </div>
                    <h3 style="color: #2d3436; font-size: 1.3rem; font-weight: 700; margin: 0;">è¾“å…¥è‹±æ–‡å†…å®¹</h3>
                </div>
                
                <!-- æ–‡æœ¬æ¡† -->
                <textarea id="english-text" 
                    placeholder="è¯·åœ¨è¿™é‡Œç²˜è´´è‹±è¯­åŸæ–‡ï¼ˆæ”¯æŒé•¿æ–‡ç¿»è¯‘ï¼‰..." 
                    style="width: 100%; min-height: 250px; padding: 1.2rem; border: 2px solid #e2e8f0; background: #f8fafc; border-radius: 12px; color: #2d3436; font-size: 1rem; line-height: 1.8; outline: none; transition: all 0.3s ease; resize: vertical; font-family: 'Microsoft YaHei', sans-serif;"
                    onfocus="this.style.border='2px solid #667eea'; this.style.background='white'; this.style.boxShadow='0 0 0 4px rgba(102, 126, 234, 0.1)';"
                    onblur="this.style.border='2px solid #e2e8f0'; this.style.background='#f8fafc'; this.style.boxShadow='none';"></textarea>
                
                <!-- ç¿»è¯‘æŒ‰é’® -->
                <button id="translate-btn" 
                    style="width: 100%; margin-top: 1.5rem; padding: 1rem 2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);"
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)';">
                    <i class="fas fa-language"></i> å¼€å§‹ç¿»è¯‘
                </button>
                
                <!-- ç¿»è¯‘ç»“æœè¾“å‡º -->
                <div id="translation-output"></div>
            </div>
            
            <!-- ç‰¹æ€§å±•ç¤º -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
                <div style="background: white; padding: 1.8rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.06); border: 2px solid #f0f0f0; transition: all 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.1)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.06)';">
                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);">
                        <i class="fas fa-bolt" style="color: white; font-size: 1.3rem;"></i>
                    </div>
                    <h4 style="color: #2d3436; font-size: 1.1rem; margin-bottom: 0.5rem;">å¿«é€Ÿç¿»è¯‘</h4>
                    <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">æ¯«ç§’çº§å“åº”ï¼Œå³æ—¶è·å–ç¿»è¯‘ç»“æœ</p>
                </div>
                
                <div style="background: white; padding: 1.8rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.06); border: 2px solid #f0f0f0; transition: all 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.1)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.06)';">
                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #34d399 0%, #10b981 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);">
                        <i class="fas fa-shield-alt" style="color: white; font-size: 1.3rem;"></i>
                    </div>
                    <h4 style="color: #2d3436; font-size: 1.1rem; margin-bottom: 0.5rem;">å®‰å…¨å¯é </h4>
                    <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">é‡‡ç”¨ç™¾åº¦ç¿»è¯‘APIï¼Œç¨³å®šé«˜æ•ˆ</p>
                </div>
                
                <div style="background: white; padding: 1.8rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.06); border: 2px solid #f0f0f0; transition: all 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.1)';"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.06)';">
                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);">
                        <i class="fas fa-infinity" style="color: white; font-size: 1.3rem;"></i>
                    </div>
                    <h4 style="color: #2d3436; font-size: 1.1rem; margin-bottom: 0.5rem;">æ— é™ä½¿ç”¨</h4>
                    <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">æ¯æœˆ100ä¸‡å­—ç¬¦å…è´¹é¢åº¦</p>
                </div>
            </div>
        
            <!-- ä½¿ç”¨è¯´æ˜å¡ç‰‡ -->
            <details style="margin-top: 2rem; background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.06); border: 2px solid #f0f0f0;">
                <summary style="cursor: pointer; font-weight: 700; color: #667eea; font-size: 1.2rem; list-style: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-question-circle"></i> å¦‚ä½•ä½¿ç”¨ç¿»è¯‘åŠŸèƒ½ï¼Ÿ
                    <i class="fas fa-chevron-down" style="margin-left: auto; font-size: 0.9rem; transition: transform 0.3s;"></i>
                </summary>
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #f0f0f0;">
                    <div style="display: grid; gap: 1.5rem;">
                        <div style="display: flex; gap: 1rem;">
                            <div style="width: 35px; height: 35px; min-width: 35px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">1</div>
                            <div>
                                <h4 style="color: #2d3436; margin-bottom: 0.3rem;">ç²˜è´´è‹±æ–‡å†…å®¹</h4>
                                <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">åœ¨ä¸Šæ–¹æ–‡æœ¬æ¡†ä¸­ç²˜è´´éœ€è¦ç¿»è¯‘çš„è‹±æ–‡å†…å®¹ï¼Œæ”¯æŒé•¿æ–‡ç¿»è¯‘</p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 1rem;">
                            <div style="width: 35px; height: 35px; min-width: 35px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">2</div>
                            <div>
                                <h4 style="color: #2d3436; margin-bottom: 0.3rem;">ç‚¹å‡»ç¿»è¯‘æŒ‰é’®</h4>
                                <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">ç‚¹å‡»"å¼€å§‹ç¿»è¯‘"æŒ‰é’®ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å¤„ç†æ‚¨çš„è¯·æ±‚</p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 1rem;">
                            <div style="width: 35px; height: 35px; min-width: 35px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">3</div>
                            <div>
                                <h4 style="color: #2d3436; margin-bottom: 0.3rem;">æŸ¥çœ‹ç¿»è¯‘ç»“æœ</h4>
                                <p style="color: #64748b; font-size: 0.95rem; line-height: 1.6;">ç¨ç­‰ç‰‡åˆ»ï¼Œç¿»è¯‘ç»“æœå°†è‡ªåŠ¨æ˜¾ç¤ºåœ¨ä¸‹æ–¹</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #d1f2eb 0%, #a7f3d0 100%); border-left: 4px solid #10b981; border-radius: 8px;">
                        <h4 style="margin: 0 0 0.8rem 0; color: #047857; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-info-circle"></i> æŠ€æœ¯è¯´æ˜
                        </h4>
                        <p style="margin: 0; color: #065f46; line-height: 1.7; font-size: 0.95rem;">
                            æœ¬ç¿»è¯‘åŠŸèƒ½ä½¿ç”¨ç™¾åº¦ç¿»è¯‘APIï¼Œå·²é¢„é…ç½®å®Œæˆã€‚æ¯æœˆ100ä¸‡å­—ç¬¦å…è´¹é¢åº¦ï¼Œç¨³å®šå¯é ï¼Œæ— éœ€ä»»ä½•é…ç½®å³å¯ä½¿ç”¨ã€‚
                        </p>
                    </div>
                </div>
            </details>
        </div>
    </main>
    
    <!-- ç®€æ´é¡µè„š -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                <h4>å››å…­çº§å­¦ä¹ ç«™</h4>
                <p>å…è´¹å¼€æ”¾çš„å››å…­çº§çœŸé¢˜å¬åŠ›èµ„æºå…±äº«ç«™</p>
            </div>
            <div class="footer-section footer-section-links">
                <h4>å¿«é€Ÿé“¾æ¥</h4>
                <ul class="footer-links">
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="cet4.html">å››çº§çœŸé¢˜</a></li>
                    <li><a href="cet6.html">å…­çº§çœŸé¢˜</a></li>
                    <li><a href="translator.html">é˜…è¯»ç¥å™¨</a></li>
                    <li><a href="listening-micro.html">å¬åŠ›å¾®ç»ƒä¹ </a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>å…³äº</h4>
                <ul class="footer-links">
                    <li><a href="news.html">è€ƒè¯•èµ„è®¯</a></li>
                    <li><a href="#">å…³äºæœ¬ç«™</a></li>
                    <li><a href="#">è”ç³»æˆ‘ä»¬</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 All Rights Reserved</p>
            <p style="margin-top: 0.5rem;">æœ¬ç«™ä»…ç”¨äºå­¦ä¹ äº¤æµï¼ŒçœŸé¢˜ç‰ˆæƒå½’åŸç‰ˆæƒæ‰€æœ‰è€…æ‰€æœ‰ã€‚</p>
        </div>
    </footer>
    <script src="app.js"></script>
    <script>
        // Vercel APIç«¯ç‚¹
        const API_ENDPOINT = 'https://cet-reading-backend.vercel.app/api/translate';

        // å…è´¹è¯å…¸APIï¼ˆä¸éœ€è¦åç«¯ï¼‰
        const FREE_DICT_API = 'https://api.dictionaryapi.dev/api/v2/entries/en/';
        const BACKUP_DICT_API = 'https://api.datamuse.com/words?sp=';
        
        // å•è¯å‘éŸ³åŠŸèƒ½ï¼ˆä½¿ç”¨æµè§ˆå™¨åŸç”ŸAPIï¼‰
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                // åœæ­¢ä¹‹å‰çš„å‘éŸ³
                window.speechSynthesis.cancel();
                
                // åˆ›å»ºè¯­éŸ³å®ä¾‹
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';  // ç¾å¼è‹±è¯­
                utterance.rate = 0.9;      // è¯­é€Ÿç¨æ…¢
                utterance.pitch = 1;       // éŸ³è°ƒ
                utterance.volume = 1;      // éŸ³é‡
                
                // æ’­æ”¾
                window.speechSynthesis.speak(utterance);
                console.log('[å‘éŸ³] æ’­æ”¾å•è¯:', word);
            } else {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½');
            }
        }
        
        // å°†è‹±æ–‡æ–‡æœ¬åˆ†è¯å¹¶å˜æˆå¯ç‚¹å‡»çš„span
        function makeWordsClickable(text) {
            // æŒ‰å•è¯åˆ†å‰²ï¼ˆä¿ç•™æ ‡ç‚¹å’Œç©ºæ ¼ï¼‰
            return text.replace(/([a-zA-Z]+(?:'[a-zA-Z]+)?)/g, (match) => {
                return `<span class="clickable-word" data-word="${match.toLowerCase()}" style="cursor: pointer; padding: 2px 4px; border-radius: 4px; transition: all 0.2s ease; display: inline-block;">${match}</span>`;
            });
        }
        
        // ä¸ºå•è¯æ·»åŠ ç‚¹å‡»äº‹ä»¶
        function attachWordClickEvents() {
            const words = document.querySelectorAll('.clickable-word');
            words.forEach(word => {
                word.addEventListener('mouseenter', function() {
                    this.style.background = 'linear-gradient(135deg, #667eea20, #764ba220)';
                    this.style.transform = 'translateY(-1px)';
                });
                word.addEventListener('mouseleave', function() {
                    this.style.background = 'transparent';
                    this.style.transform = 'translateY(0)';
                });
                word.addEventListener('click', function() {
                    const wordText = this.getAttribute('data-word');
                    lookupWord(wordText, this);
                });
            });
        }
        
        // æŸ¥è¯¢å•è¯ï¼ˆä½¿ç”¨å…è´¹APIï¼Œä¸ä¾èµ–åç«¯ï¼‰
        async function lookupWord(word, element) {
            showWordPopup(element, `
                <div style="text-align: center; padding: 1.5rem;">
                    <i class="fas fa-spinner fa-spin" style="color: #667eea; font-size: 1.8rem;"></i>
                    <p style="margin-top: 0.8rem; color: #64748b; font-size: 0.95rem;">æŸ¥è¯¢ä¸­...</p>
                </div>
            `);
            
            console.log('[Word Lookup] æŸ¥è¯¢å•è¯:', word);
            
            try {
                const cleanWord = word.toLowerCase().trim();
                
                // æ–¹æ³•1ï¼šä½¿ç”¨å…è´¹è¯å…¸APIï¼ˆdictionaryapi.devï¼‰
                try {
                    const response = await fetch(FREE_DICT_API + encodeURIComponent(cleanWord), {
                        method: 'GET',
                        signal: AbortSignal.timeout(8000)
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('[Word Lookup] å…è´¹APIè¿”å›:', data);
                        
                        if (Array.isArray(data) && data.length > 0) {
                            const wordData = data[0];
                            
                            // æå–éŸ³æ ‡
                            let phonetic = '';
                            if (wordData.phonetic) {
                                phonetic = wordData.phonetic;
                            } else if (wordData.phonetics && wordData.phonetics.length > 0) {
                                const ph = wordData.phonetics.find(p => p.text);
                                if (ph) phonetic = ph.text;
                            }
                            phonetic = phonetic.replace(/^\/|\/$|^\[|\]$/g, '');
                            
                            // æå–é‡Šä¹‰
                            const meanings = [];
                            if (wordData.meanings && Array.isArray(wordData.meanings)) {
                                wordData.meanings.forEach(meaning => {
                                    const pos = meaning.partOfSpeech || '';
                                    if (meaning.definitions && Array.isArray(meaning.definitions)) {
                                        meaning.definitions.slice(0, 3).forEach(def => {
                                            if (def.definition) {
                                                meanings.push(`${pos ? pos + '. ' : ''}${def.definition}`);
                                                // æ·»åŠ ä¾‹å¥
                                                if (def.example) {
                                                    meanings.push(`Â Â ä¾‹: ${def.example}`);
                                                }
                                            }
                                        });
                                    }
                                });
                            }
                            
                            displayWordInfo({
                                query: cleanWord,
                                phonetic: phonetic,
                                explains: meanings,
                                translation: meanings.length > 0 ? meanings[0] : ''
                            }, element);
                            return;
                        }
                    }
                } catch (apiError) {
                    console.warn('[Word Lookup] å…è´¹APIå¤±è´¥:', apiError.message);
                }
                
                // æ–¹æ³•2ï¼šå¤‡ç”¨APIï¼ˆdatamuseï¼‰
                try {
                    const response = await fetch(BACKUP_DICT_API + encodeURIComponent(cleanWord) + '&md=d&max=1', {
                        method: 'GET',
                        signal: AbortSignal.timeout(5000)
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('[Word Lookup] å¤‡ç”¨APIè¿”å›:', data);
                        
                        if (Array.isArray(data) && data.length > 0 && data[0].defs) {
                            const defs = data[0].defs.map(def => {
                                // æ ¼å¼ï¼š"n\tthe definition" -> "n. the definition"
                                return def.replace(/\t/, '. ');
                            });
                            
                            displayWordInfo({
                                query: cleanWord,
                                phonetic: '',
                                explains: defs,
                                translation: defs[0] || ''
                            }, element);
                            return;
                        }
                    }
                } catch (backupError) {
                    console.warn('[Word Lookup] å¤‡ç”¨APIå¤±è´¥:', backupError.message);
                }
                
                // æ‰€æœ‰APIéƒ½å¤±è´¥
                throw new Error('æœªæ‰¾åˆ°è¯¥å•è¯çš„é‡Šä¹‰');
                
            } catch (error) {
                console.error('[Word Lookup] æŸ¥è¯¢å¤±è´¥:', error);
                
                showWordPopup(element, `
                    <div style="text-align: center; padding: 1.5rem;">
                        <i class="fas fa-info-circle" style="color: #f59e0b; font-size: 1.8rem;"></i>
                        <p style="margin-top: 0.8rem; color: #2d3436; font-weight: 600;">æœªæ‰¾åˆ°è¯¥å•è¯</p>
                        <p style="margin-top: 0.5rem; color: #64748b; font-size: 0.9rem;">è¯·å°è¯•å…¶ä»–å•è¯</p>
                        <button onclick="document.getElementById('word-popup').remove()" 
                            style="margin-top: 1rem; padding: 0.5rem 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                            å…³é—­
                        </button>
                    </div>
                `);
            }
        }
        
        // ç¿»è¯‘è‹±æ–‡é‡Šä¹‰ä¸ºä¸­æ–‡
        async function translateText(text) {
            try {
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text }),
                    signal: AbortSignal.timeout(5000)
                });
                if (response.ok) {
                    const data = await response.json();
                    return data.result || text;
                }
            } catch (e) {
                console.warn('[Translate] ç¿»è¯‘å¤±è´¥:', e.message);
            }
            return text;
        }
        
        // æ˜¾ç¤ºå•è¯ä¿¡æ¯å¼¹çª—ï¼ˆæœ‰é“è¯å…¸é£æ ¼ï¼‰
        async function displayWordInfo(data, element) {
            console.log('[Word Lookup] è§£ææ˜¾ç¤ºæ•°æ®:', data);
            
            const word = data.query || element.getAttribute('data-word') || '';
            const phonetic = data.phonetic || '';
            const explains = data.explains || [];
            
            // ç¿»è¯‘è‹±æ–‡é‡Šä¹‰ä¸ºä¸­æ–‡ï¼ˆå¼‚æ­¥ï¼‰
            const translatedExplains = [];
            for (let i = 0; i < Math.min(explains.length, 5); i++) {
                const exp = explains[i];
                if (exp && !exp.startsWith('  ä¾‹:')) {  // ä¸ç¿»è¯‘ä¾‹å¥
                    const translated = await translateText(exp);
                    translatedExplains.push({ en: exp, zh: translated });
                }
            }
            
            let html = `
                <div style="min-width: 380px; max-width: 500px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;">
                    <!-- å•è¯æ ‡é¢˜ï¼ˆæœ‰é“é£æ ¼ï¼‰ -->
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 1.3rem 1.5rem; border-radius: 12px 12px 0 0; margin: -1.2rem -1.2rem 0 -1.2rem; box-shadow: 0 2px 8px rgba(79, 172, 254, 0.3);">
                        <h3 style="margin: 0; color: white; font-size: 1.6rem; font-weight: 700; text-transform: capitalize; letter-spacing: 0.5px;">${word}</h3>
                        ${phonetic ? `
                            <div style="margin-top: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span style="color: rgba(255,255,255,0.95); font-size: 1rem;">[${phonetic}]</span>
                                <button onclick="speakWord('${word}')" 
                                    style="background: rgba(255,255,255,0.25); border: none; color: white; padding: 0.4rem 0.8rem; border-radius: 8px; cursor: pointer; font-size: 0.85rem; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); font-weight: 600;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.4)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'"
                                    onmouseout="this.style.background='rgba(255,255,255,0.25)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                                    <i class="fas fa-volume-up"></i> å‘éŸ³
                                </button>
                            </div>
                        ` : ''}
                    </div>
                    
                    <!-- ä¸­è‹±å¯¹ç…§é‡Šä¹‰ï¼ˆæœ‰é“é£æ ¼ï¼‰ -->
                    ${translatedExplains.length > 0 ? `
                        <div style="padding: 1.2rem; background: white;">
                            <h4 style="margin: 0 0 1rem 0; color: #2c3e50; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                                <span style="display: inline-block; width: 4px; height: 16px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 2px;"></span>
                                åŸºæœ¬é‡Šä¹‰
                            </h4>
                            <div style="space-y: 0.8rem;">
                                ${translatedExplains.map((item, idx) => `
                                    <div style="margin-bottom: 1rem; padding: 0.8rem; background: #f8fafc; border-radius: 8px; border-left: 3px solid #4facfe;">
                                        <div style="color: #2c3e50; font-size: 0.95rem; line-height: 1.6; margin-bottom: 0.4rem;">
                                            <span style="display: inline-block; width: 20px; height: 20px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; text-align: center; line-height: 20px; border-radius: 50%; font-size: 0.75rem; font-weight: 600; margin-right: 0.5rem;">${idx + 1}</span>
                                            <span style="font-weight: 500;">${item.en}</span>
                                        </div>
                                        <div style="color: #10b981; font-size: 0.9rem; padding-left: 2rem; line-height: 1.5;">
                                            <i class="fas fa-language" style="margin-right: 0.3rem; opacity: 0.7;"></i>
                                            ${item.zh}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : `
                        <div style="text-align: center; padding: 2rem; color: #94a3b8;">
                            <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 0.8rem; display: block;"></i>
                            <p style="margin: 0; font-size: 0.95rem;">æœªæ‰¾åˆ°è¯¥å•è¯çš„è¯¦ç»†é‡Šä¹‰</p>
                        </div>
                    `}
                </div>
            `;
            
            showWordPopup(element, html);
        }
        
        // æ˜¾ç¤ºå¼¹çª—ï¼ˆä¼˜åŒ–æ ·å¼å’Œä½ç½®ï¼‰
        function showWordPopup(element, content) {
            // ç§»é™¤å·²å­˜åœ¨çš„å¼¹çª—
            const existingPopup = document.getElementById('word-popup');
            if (existingPopup) {
                existingPopup.style.animation = 'popupFadeOut 0.15s ease';
                setTimeout(() => existingPopup.remove(), 150);
            }
            
            // åˆ›å»ºæ–°å¼¹çª—
            const popup = document.createElement('div');
            popup.id = 'word-popup';
            popup.innerHTML = content;
            popup.style.cssText = `
                position: fixed;
                background: white;
                padding: 1.2rem;
                border-radius: 16px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.15), 0 0 1px rgba(0,0,0,0.1);
                z-index: 10000;
                max-height: 85vh;
                overflow-y: auto;
                border: 1px solid rgba(79, 172, 254, 0.2);
                animation: popupFadeIn 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
            `;
            
            // æ·»åŠ åŠ¨ç”»æ ·å¼
            if (!document.getElementById('popup-animation-style')) {
                const style = document.createElement('style');
                style.id = 'popup-animation-style';
                style.textContent = `
                    @keyframes popupFadeIn {
                        from { 
                            opacity: 0; 
                            transform: translateY(-20px) scale(0.92); 
                        }
                        to { 
                            opacity: 1; 
                            transform: translateY(0) scale(1); 
                        }
                    }
                    @keyframes popupFadeOut {
                        from { 
                            opacity: 1; 
                            transform: scale(1); 
                        }
                        to { 
                            opacity: 0; 
                            transform: scale(0.95); 
                        }
                    }
                    #word-popup::-webkit-scrollbar {
                        width: 8px;
                    }
                    #word-popup::-webkit-scrollbar-track {
                        background: #f1f5f9;
                        border-radius: 4px;
                    }
                    #word-popup::-webkit-scrollbar-thumb {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                        border-radius: 4px;
                    }
                    #word-popup::-webkit-scrollbar-thumb:hover {
                        background: linear-gradient(135deg, #3b9ce8 0%, #00d9ea 100%);
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(popup);
            
            // æ™ºèƒ½è®¡ç®—ä½ç½®
            const rect = element.getBoundingClientRect();
            const popupRect = popup.getBoundingClientRect();
            const padding = 15;
            
            // é»˜è®¤å±…ä¸­å¯¹é½
            let left = rect.left + (rect.width / 2) - (popupRect.width / 2);
            let top = rect.bottom + padding;
            
            // æ°´å¹³æ–¹å‘è°ƒæ•´
            if (left < padding) {
                left = padding;
            } else if (left + popupRect.width > window.innerWidth - padding) {
                left = window.innerWidth - popupRect.width - padding;
            }
            
            // å‚ç›´æ–¹å‘è°ƒæ•´ï¼ˆå¦‚æœä¸‹æ–¹ç©ºé—´ä¸å¤Ÿï¼Œæ˜¾ç¤ºåœ¨ä¸Šæ–¹ï¼‰
            if (top + popupRect.height > window.innerHeight - padding) {
                top = rect.top - popupRect.height - padding;
                // å¦‚æœä¸Šæ–¹ä¹Ÿæ”¾ä¸ä¸‹ï¼Œå°±æ˜¾ç¤ºåœ¨å±å¹•ä¸­é—´
                if (top < padding) {
                    top = (window.innerHeight - popupRect.height) / 2;
                    if (top < padding) top = padding;
                }
            }
            
            popup.style.left = left + 'px';
            popup.style.top = top + 'px';
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ï¼ˆå¸¦åŠ¨ç”»ï¼‰
            setTimeout(() => {
                const closeHandler = function(e) {
                    if (!popup.contains(e.target) && e.target !== element && !e.target.closest('.clickable-word')) {
                        popup.style.animation = 'popupFadeOut 0.15s ease';
                        setTimeout(() => popup.remove(), 150);
                        document.removeEventListener('click', closeHandler);
                    }
                };
                document.addEventListener('click', closeHandler);
            }, 100);
        }
        
        // ç¿»è¯‘åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', () => {
            const translateBtn = document.getElementById('translate-btn');
            
            translateBtn.addEventListener('click', async () => {
                const text = document.getElementById('english-text').value.trim();
                const outputDiv = document.getElementById('translation-output');
                
                if (!text) {
                    outputDiv.innerHTML = `
                        <div style="padding: 2rem; text-align: center; color: #856404; background: #fff3cd; border-radius: 8px; margin-top: 1.5rem;">
                            <i class="fas fa-exclamation-circle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>è¯·è¾“å…¥è‹±æ–‡å†…å®¹åå†ç¿»è¯‘</p>
                        </div>
                    `;
                    return;
                }
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                outputDiv.innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: #004085; background: #cce5ff; border-radius: 8px; margin-top: 1.5rem;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>æ­£åœ¨ç¿»è¯‘ä¸­ï¼Œè¯·ç¨å€™...</p>
                    </div>
                `;
                
                try {
                    // è°ƒç”¨Vercelä»£ç†API
                    const response = await fetch(API_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ text })
                    });
                    
                    if (!response.ok) {
                        throw new Error('ç¿»è¯‘æœåŠ¡æš‚æ—¶ä¸å¯ç”¨');
                    }
                    
                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error);
                    }
                    
                    // æ˜¾ç¤ºç¿»è¯‘ç»“æœï¼ˆåŸæ–‡ + è¯‘æ–‡ï¼Œå•è¯å¯ç‚¹å‡»ï¼‰
                    const clickableText = makeWordsClickable(text);
                    outputDiv.innerHTML = `
                        <div style="margin-top: 2rem; padding: 2rem; background: white; border-radius: 12px; box-shadow: 0 2px 15px rgba(0,0,0,0.1);">
                            <h3 style="margin: 0 0 1rem 0; color: #333; border-bottom: 2px solid #007AFF; padding-bottom: 0.5rem;">
                                <i class="fas fa-language" style="color: #667eea;"></i> è‹±æ–‡åŸæ–‡
                                <span style="font-size: 0.8rem; color: #64748b; font-weight: 400; margin-left: 0.5rem;">ï¼ˆç‚¹å‡»å•è¯æŸ¥çœ‹é‡Šä¹‰ï¼‰</span>
                            </h3>
                            <div id="clickable-english" style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; line-height: 2; color: #2d3436; font-size: 1.05rem; border: 2px solid #e2e8f0;">
                                ${clickableText}
                            </div>
                            
                            <h3 style="margin: 2rem 0 1rem 0; color: #333; border-bottom: 2px solid #10b981; padding-bottom: 0.5rem;">
                                <i class="fas fa-check-circle" style="color: #10b981;"></i> ä¸­æ–‡ç¿»è¯‘
                            </h3>
                            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; line-height: 1.8; color: #333; font-size: 1.05rem;">
                                ${data.result}
                            </div>
                        </div>
                    `;
                    
                    // ä¸ºå•è¯æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    attachWordClickEvents();
                } catch (error) {
                    outputDiv.innerHTML = `
                        <div style="padding: 2rem; text-align: center; color: #721c24; background: #f8d7da; border-radius: 8px; margin-top: 1.5rem;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p><strong>ç¿»è¯‘å¤±è´¥ï¼</strong></p>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">é”™è¯¯ä¿¡æ¯ï¼š${error.message}</p>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">è¯·ç¨åå†è¯•</p>
                        </div>
                    `;
                }
            });
        });
    </script>
</body>
</html>
